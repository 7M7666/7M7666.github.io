<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CSAPP Bomb Lab 详细解析与复习笔记 - &lt;/&gt;7M7&#39;s blog</title><meta name="author" content="7M7">
<meta name="description" content="深入理解计算机系统(CSAPP) Bomb Lab 实验的详细通关解析，涵盖汇编指令分析、GDB调试技巧及6个关卡的解题思路。"><meta name="keywords" content='CSAPP, 汇编, Linux, GDB'>
  <meta itemprop="name" content="CSAPP Bomb Lab 详细解析与复习笔记">
  <meta itemprop="description" content="深入理解计算机系统(CSAPP) Bomb Lab 实验的详细通关解析，涵盖汇编指令分析、GDB调试技巧及6个关卡的解题思路。">
  <meta itemprop="datePublished" content="2025-12-01T19:23:27+08:00">
  <meta itemprop="dateModified" content="2025-12-01T19:23:27+08:00">
  <meta itemprop="wordCount" content="1922">
  <meta itemprop="keywords" content="CSAPP,汇编,Linux,GDB"><meta property="og:url" content="http://localhost:1313/posts/017d597/">
  <meta property="og:site_name" content="&lt;/&gt;7M7&#39;s blog">
  <meta property="og:title" content="CSAPP Bomb Lab 详细解析与复习笔记">
  <meta property="og:description" content="深入理解计算机系统(CSAPP) Bomb Lab 实验的详细通关解析，涵盖汇编指令分析、GDB调试技巧及6个关卡的解题思路。">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-01T19:23:27+08:00">
    <meta property="article:modified_time" content="2025-12-01T19:23:27+08:00">
    <meta property="article:tag" content="CSAPP">
    <meta property="article:tag" content="汇编">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="GDB">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="CSAPP Bomb Lab 详细解析与复习笔记">
  <meta name="twitter:description" content="深入理解计算机系统(CSAPP) Bomb Lab 实验的详细通关解析，涵盖汇编指令分析、GDB调试技巧及6个关卡的解题思路。">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/c.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/posts/017d597/" title="CSAPP Bomb Lab 详细解析与复习笔记 - &lt;/&gt;7M7&#39;s blog" /><link rel="prev" type="text/html" href="http://localhost:1313/posts/017d599/" title="8086 汇编系统笔记：内存分段、栈、寻址与控制转移" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/posts/017d597/index.md" title="CSAPP Bomb Lab 详细解析与复习笔记 - </>7M7's blog"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CSAPP Bomb Lab 详细解析与复习笔记",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/posts\/017d597\/"
    },"genre": "posts","keywords": "CSAPP, 汇编, Linux, GDB","wordcount":  1922 ,
    "url": "http:\/\/localhost:1313\/posts\/017d597\/","datePublished": "2025-12-01T19:23:27+08:00","dateModified": "2025-12-01T19:23:27+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "7M7"
      },"description": "深入理解计算机系统(CSAPP) Bomb Lab 实验的详细通关解析，涵盖汇编指令分析、GDB调试技巧及6个关卡的解题思路。"
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper" data-github-corner="left">
    <div class="header-title">
      <a href="/" title="&lt;/&gt;7M7&#39;s blog"><img class="logo" src='/img/c.jpg' alt="&lt;/&gt;7M7&#39;s blog" height="32" width="32"><span class="header-title-text">&lt;/&gt;7M7&#39;s blog</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/archives/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Archives</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章.." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="&lt;/&gt;7M7&#39;s blog"><img class="logo" src='/img/c.jpg' alt="&lt;/&gt;7M7&#39;s blog" height="26" width="26"><span class="header-title-text">&lt;/&gt;7M7&#39;s blog</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章.." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Cancel
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/archives/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Archives</a></li><li class="menu-item"><a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><nav aria-label="breadcrumb" class="breadcrumb-container sticky">
    <ol class="breadcrumb"><li class="breadcrumb-item" data-separator="&gt;"><a href="/" title="&lt;/&gt;7M7&#39;s Blog">Home</a></li><li class="breadcrumb-item" data-separator="&gt;"><a href="/posts/" title="Posts">Posts</a></li><li class="breadcrumb-item active" data-separator="&gt;" aria-current="page">CSAPP Bomb Lab 详细解析与复习笔记</li>
    </ol>
  </nav><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CSAPP Bomb Lab 详细解析与复习笔记</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img class="avatar" src='/img/a.jpg' alt="7M7" height="16" width="16">&nbsp;7M7</span></span><span class="post-included-in">&nbsp;included in <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" class="post-category" title="Category - 计算机基础"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 计算机基础</a>&ensp;<a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-category" title="Category - 学习笔记"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 学习笔记</a></span></div><div class="post-meta-line"><span title="published on 2025-12-01 19:23:27"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-12-01">2025-12-01</time></span>&nbsp;<span title="1922 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 2000 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>10 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#一实验简介不止于拆弹的底层修炼">一、实验简介：不止于“拆弹”的底层修炼</a></li>
    <li><a href="#二核心基础拆弹前必须掌握的内功心法">二、核心基础：拆弹前必须掌握的“内功心法”</a>
      <ul>
        <li><a href="#21-x86-64-寄存器使用惯例重中之重">2.1 x86-64 寄存器使用惯例（重中之重）</a></li>
        <li><a href="#22-gdb-调试工具拆弹必备神器">2.2 GDB 调试工具：拆弹必备“神器”</a>
          <ul>
            <li><a href="#1基础操作启动与反汇编">（1）基础操作：启动与反汇编</a></li>
            <li><a href="#2断点与执行控制">（2）断点与执行控制</a></li>
            <li><a href="#3数据查看核心中的核心">（3）数据查看：核心中的核心</a></li>
          </ul>
        </li>
        <li><a href="#23-关键汇编指令解析避坑指南">2.3 关键汇编指令解析：避坑指南</a>
          <ul>
            <li><a href="#1lea-vs-mov地址-vs-数值">（1）<code>lea</code> vs <code>mov</code>：地址 vs 数值</a></li>
            <li><a href="#2cmp-vs-test条件判断的核心">（2）<code>cmp</code> vs <code>test</code>：条件判断的核心</a></li>
            <li><a href="#3跳转指令标志位依赖">（3）跳转指令：标志位依赖</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#三逐阶段拆弹从易到难深度解析">三、逐阶段拆弹：从易到难深度解析</a>
      <ul>
        <li><a href="#31-phase-1字符串比较热身题">3.1 Phase 1：字符串比较（热身题）</a>
          <ul>
            <li><a href="#核心考点函数调用约定字符串地址访问">核心考点：函数调用约定、字符串地址访问</a></li>
            <li><a href="#汇编逐行解析">汇编逐行解析</a></li>
            <li><a href="#解法步骤">解法步骤</a></li>
            <li><a href="#答案验证">答案验证</a></li>
          </ul>
        </li>
        <li><a href="#32-phase-2循环与栈数组序列推导">3.2 Phase 2：循环与栈数组（序列推导）</a>
          <ul>
            <li><a href="#核心考点栈上局部变量数组循环结构指针算术">核心考点：栈上局部变量（数组）、循环结构、指针算术</a></li>
            <li><a href="#汇编逐行解析-1">汇编逐行解析</a></li>
            <li><a href="#核心逻辑推导">核心逻辑推导</a></li>
            <li><a href="#解法步骤-1">解法步骤</a></li>
            <li><a href="#答案">答案</a></li>
          </ul>
        </li>
        <li><a href="#33-phase-3switch-跳转表多路分支">3.3 Phase 3：Switch 跳转表（多路分支）</a>
          <ul>
            <li><a href="#核心考点switch-case-底层实现跳转表多参数输入解析">核心考点：switch-case 底层实现（跳转表）、多参数输入解析</a></li>
            <li><a href="#汇编逐行解析-2">汇编逐行解析</a></li>
            <li><a href="#核心逻辑推导-1">核心逻辑推导</a></li>
            <li><a href="#解法步骤-2">解法步骤</a></li>
            <li><a href="#答案-1">答案</a></li>
          </ul>
        </li>
        <li><a href="#34-phase-4递归函数二分查找">3.4 Phase 4：递归函数（二分查找）</a>
          <ul>
            <li><a href="#核心考点递归调用栈帧生长二分查找逻辑">核心考点：递归调用、栈帧生长、二分查找逻辑</a></li>
            <li><a href="#汇编逐行解析-3">汇编逐行解析</a></li>
            <li><a href="#核心逻辑推导-2">核心逻辑推导</a></li>
            <li><a href="#解法步骤-3">解法步骤</a></li>
            <li><a href="#答案-2">答案</a></li>
          </ul>
        </li>
        <li><a href="#35-phase-5位操作与字符映射">3.5 Phase 5：位操作与字符映射</a>
          <ul>
            <li><a href="#核心考点位运算数组索引字符串映射">核心考点：位运算、数组索引、字符串映射</a></li>
            <li><a href="#汇编逐行解析-4">汇编逐行解析</a></li>
            <li><a href="#核心逻辑推导-3">核心逻辑推导</a></li>
            <li><a href="#解法步骤-4">解法步骤</a></li>
            <li><a href="#答案-3">答案</a></li>
          </ul>
        </li>
        <li><a href="#36-phase-6链表排序">3.6 Phase 6：链表排序</a>
          <ul>
            <li><a href="#核心考点结构体指针链表遍历指针重排排序逻辑">核心考点：结构体指针、链表遍历、指针重排、排序逻辑</a></li>
            <li><a href="#汇编逐行解析-5">汇编逐行解析</a></li>
            <li><a href="#核心逻辑推导-4">核心逻辑推导</a></li>
            <li><a href="#解法步骤核心三步">解法步骤（核心三步）</a></li>
            <li><a href="#答案需按实际链表值调整">答案（需按实际链表值调整）</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="csapp-bomb-lab-复习笔记"><span>CSAPP Bomb Lab 复习笔记</span>
  <a href="#csapp-bomb-lab-%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h2 class="heading-element" id="一实验简介不止于拆弹的底层修炼"><span>一、实验简介：不止于“拆弹”的底层修炼</span>
  <a href="#%e4%b8%80%e5%ae%9e%e9%aa%8c%e7%ae%80%e4%bb%8b%e4%b8%8d%e6%ad%a2%e4%ba%8e%e6%8b%86%e5%bc%b9%e7%9a%84%e5%ba%95%e5%b1%82%e4%bf%ae%e7%82%bc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Bomb Lab 是《深入理解计算机系统》（CSAPP）第三章「程序的机器级表示」的核心配套实验。实验核心是通过反汇编二进制程序 <code>bomb</code>，分析 x86-64 汇编代码的逻辑，推断出 6 个“炸弹阶段”的输入字符串，解除炸弹。</p>
<p><strong>实验价值</strong>：</p>
<ul>
<li>不是死记硬背答案，而是掌握「汇编指令解析」「栈帧结构」「函数调用约定」「控制流（循环、switch、递归、链表）底层实现」等核心知识；</li>
<li>熟练使用 GDB 调试工具，建立“代码-汇编-内存”的映射思维，为后续操作系统、编译原理学习打基础。</li>
</ul>
<h2 class="heading-element" id="二核心基础拆弹前必须掌握的内功心法"><span>二、核心基础：拆弹前必须掌握的“内功心法”</span>
  <a href="#%e4%ba%8c%e6%a0%b8%e5%bf%83%e5%9f%ba%e7%a1%80%e6%8b%86%e5%bc%b9%e5%89%8d%e5%bf%85%e9%a1%bb%e6%8e%8c%e6%8f%a1%e7%9a%84%e5%86%85%e5%8a%9f%e5%bf%83%e6%b3%95" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="21-x86-64-寄存器使用惯例重中之重"><span>2.1 x86-64 寄存器使用惯例（重中之重）</span>
  <a href="#21-x86-64-%e5%af%84%e5%ad%98%e5%99%a8%e4%bd%bf%e7%94%a8%e6%83%af%e4%be%8b%e9%87%8d%e4%b8%ad%e4%b9%8b%e9%87%8d" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>x86-64 寄存器共 16 个（%rax-%r15），按功能分为三类，<strong>必须牢记函数调用中的角色</strong>：</p>
<table>
  <thead>
      <tr>
          <th>寄存器</th>
          <th>功能说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>%rdi/%rsi/%rdx/%rcx/%r8/%r9</td>
          <td>函数第 1-6 个参数（顺序严格对应，超过 6 个参数通过栈传递）</td>
      </tr>
      <tr>
          <td>%rax</td>
          <td>函数返回值；同时是临时寄存器（调用者无需保存）</td>
      </tr>
      <tr>
          <td>%rsp</td>
          <td>栈顶指针（Stack Pointer）：push/pop 时自动增减，指向当前栈顶</td>
      </tr>
      <tr>
          <td>%rbp</td>
          <td>栈底/帧指针（Base Pointer）：固定指向当前函数栈帧底部，用于定位局部变量</td>
      </tr>
      <tr>
          <td>%rbx/%r12-%r15</td>
          <td>被调用者保存寄存器（Callee-saved）：函数使用前必须 push 保存，退出前 pop 恢复</td>
      </tr>
      <tr>
          <td>%r10/%r11</td>
          <td>临时寄存器（Caller-saved）：调用者无需保存，被调用函数可随意修改</td>
      </tr>
  </tbody>
</table>
<h3 class="heading-element" id="22-gdb-调试工具拆弹必备神器"><span>2.2 GDB 调试工具：拆弹必备“神器”</span>
  <a href="#22-gdb-%e8%b0%83%e8%af%95%e5%b7%a5%e5%85%b7%e6%8b%86%e5%bc%b9%e5%bf%85%e5%a4%87%e7%a5%9e%e5%99%a8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>无需盲目猜测代码逻辑，用 GDB 直接查看内存、寄存器、指令执行过程，高效定位答案。</p>
<h4 class="heading-element" id="1基础操作启动与反汇编"><span>（1）基础操作：启动与反汇编</span>
  <a href="#1%e5%9f%ba%e7%a1%80%e6%93%8d%e4%bd%9c%e5%90%af%e5%8a%a8%e4%b8%8e%e5%8f%8d%e6%b1%87%e7%bc%96" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 1. 导出完整反汇编代码</span>
</span></span><span class="line"><span class="cl">objdump -d bomb &gt; bomb.asm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2. 启动 GDB 调试</span>
</span></span><span class="line"><span class="cl">gdb bomb</span></span></code></pre></td></tr></table>
</div>
</div><h4 class="heading-element" id="2断点与执行控制"><span>（2）断点与执行控制</span>
  <a href="#2%e6%96%ad%e7%82%b9%e4%b8%8e%e6%89%a7%e8%a1%8c%e6%8e%a7%e5%88%b6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><table>
  <thead>
      <tr>
          <th>指令</th>
          <th>功能说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>b phase_1</code></td>
          <td>在函数 <code>phase_1</code> 入口打断点（直接按函数名打断点，最常用）</td>
      </tr>
      <tr>
          <td><code>b *0x400ee0</code></td>
          <td>在内存地址 0x400ee0 打断点（函数过长时，精准定位某条指令）</td>
      </tr>
      <tr>
          <td><code>r</code>（run）</td>
          <td>运行程序，输入字符串后触发断点</td>
      </tr>
      <tr>
          <td><code>ni</code>（nexti）</td>
          <td>单步跳过指令（不进入函数调用，如 <code>callq strings_not_equal</code> 直接执行完）</td>
      </tr>
      <tr>
          <td><code>si</code>（stepi）</td>
          <td>单步进入指令（进入函数内部，如查看 <code>strings_not_equal</code> 的执行逻辑）</td>
      </tr>
      <tr>
          <td><code>c</code>（continue）</td>
          <td>继续执行到下一个断点</td>
      </tr>
      <tr>
          <td><code>q</code>（quit）</td>
          <td>退出 GDB</td>
      </tr>
  </tbody>
</table>
<h4 class="heading-element" id="3数据查看核心中的核心"><span>（3）数据查看：核心中的核心</span>
  <a href="#3%e6%95%b0%e6%8d%ae%e6%9f%a5%e7%9c%8b%e6%a0%b8%e5%bf%83%e4%b8%ad%e7%9a%84%e6%a0%b8%e5%bf%83" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><table>
  <thead>
      <tr>
          <th>指令</th>
          <th>功能说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>x/s 0x402400</code></td>
          <td>以字符串（String）格式查看地址 0x402400 处的内容（Phase 1 直接用）</td>
      </tr>
      <tr>
          <td><code>x/d $rsp</code></td>
          <td>以十进制（d）查看栈顶（%rsp 指向）的值</td>
      </tr>
      <tr>
          <td><code>x/6wd $rsp</code></td>
          <td>以十进制（d）查看栈顶开始的 6 个“字（4字节）”（查看数组/输入的多个整数）</td>
      </tr>
      <tr>
          <td><code>x/8xg 0x402470</code></td>
          <td>以 8 字节（x）、十六进制（g）查看跳转表（Phase 3 用）</td>
      </tr>
      <tr>
          <td><code>i r</code>（info registers）</td>
          <td>查看所有寄存器当前值</td>
      </tr>
      <tr>
          <td><code>p $rax</code></td>
          <td>打印寄存器 %rax 的值（验证函数返回值、计算结果）</td>
      </tr>
      <tr>
          <td><code>p *(int*)0x6032d0</code></td>
          <td>以 int 类型查看地址 0x6032d0 处的值（查看链表节点、结构体字段）</td>
      </tr>
  </tbody>
</table>
<h3 class="heading-element" id="23-关键汇编指令解析避坑指南"><span>2.3 关键汇编指令解析：避坑指南</span>
  <a href="#23-%e5%85%b3%e9%94%ae%e6%b1%87%e7%bc%96%e6%8c%87%e4%bb%a4%e8%a7%a3%e6%9e%90%e9%81%bf%e5%9d%91%e6%8c%87%e5%8d%97" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>x86-64 汇编指令众多，重点掌握易混淆、高频出现的指令，避免因理解偏差踩坑。</p>
<h4 class="heading-element" id="1lea-vs-mov地址-vs-数值"><span>（1）<code>lea</code> vs <code>mov</code>：地址 vs 数值</span>
  <a href="#1lea-vs-mov%e5%9c%b0%e5%9d%80-vs-%e6%95%b0%e5%80%bc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><table>
  <thead>
      <tr>
          <th>指令</th>
          <th>功能说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>mov (%rdi), %rax</code></td>
          <td>间接寻址：取 %rdi 指向的<strong>内存地址中的值</strong>，放入 %rax（访问内存）</td>
      </tr>
      <tr>
          <td><code>lea (%rdi), %rax</code></td>
          <td>地址传送：将 %rdi 本身的<strong>地址值</strong>放入 %rax（不访问内存），常用于指针运算</td>
      </tr>
      <tr>
          <td><code>lea (%rdi, %rdi, 2), %rax</code></td>
          <td>计算 <code>%rdi * 3</code>（公式：基址 + 索引<em>比例，即 x + x</em>2 = 3x）</td>
      </tr>
  </tbody>
</table>
<h4 class="heading-element" id="2cmp-vs-test条件判断的核心"><span>（2）<code>cmp</code> vs <code>test</code>：条件判断的核心</span>
  <a href="#2cmp-vs-test%e6%9d%a1%e4%bb%b6%e5%88%a4%e6%96%ad%e7%9a%84%e6%a0%b8%e5%bf%83" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><table>
  <thead>
      <tr>
          <th>指令</th>
          <th>功能说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>cmp a, b</code></td>
          <td>计算 <code>b - a</code>，不保存结果，仅设置标志位（ZF=0 表示不等，ZF=1 表示相等）</td>
      </tr>
      <tr>
          <td><code>test %eax, %eax</code></td>
          <td>计算 <code>%eax &amp; %eax</code>，等价于检查 %eax 是否为 0（ZF=1 则为 0）</td>
      </tr>
      <tr>
          <td><code>test %rdi, %rsi</code></td>
          <td>计算 <code>%rdi &amp; %rsi</code>，检查两个值是否有共同的置位比特</td>
      </tr>
  </tbody>
</table>
<h4 class="heading-element" id="3跳转指令标志位依赖"><span>（3）跳转指令：标志位依赖</span>
  <a href="#3%e8%b7%b3%e8%bd%ac%e6%8c%87%e4%bb%a4%e6%a0%87%e5%bf%97%e4%bd%8d%e4%be%9d%e8%b5%96" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><table>
  <thead>
      <tr>
          <th>指令</th>
          <th>依赖标志位</th>
          <th>功能说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>je 0x400ef7</code></td>
          <td>ZF=1</td>
          <td>相等则跳转（jump equal）</td>
      </tr>
      <tr>
          <td><code>jne 0x400f3c</code></td>
          <td>ZF=0</td>
          <td>不等则跳转（jump not equal）</td>
      </tr>
      <tr>
          <td><code>ja 0x400fad</code></td>
          <td>CF=0 且 ZF=0</td>
          <td>无符号数大于则跳转（jump above）</td>
      </tr>
      <tr>
          <td><code>jle 0x400f80</code></td>
          <td>CF=1 或 ZF=1</td>
          <td>无符号数小于等于则跳转（jump less or equal）</td>
      </tr>
  </tbody>
</table>
<h2 class="heading-element" id="三逐阶段拆弹从易到难深度解析"><span>三、逐阶段拆弹：从易到难深度解析</span>
  <a href="#%e4%b8%89%e9%80%90%e9%98%b6%e6%ae%b5%e6%8b%86%e5%bc%b9%e4%bb%8e%e6%98%93%e5%88%b0%e9%9a%be%e6%b7%b1%e5%ba%a6%e8%a7%a3%e6%9e%90" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="31-phase-1字符串比较热身题"><span>3.1 Phase 1：字符串比较（热身题）</span>
  <a href="#31-phase-1%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%af%94%e8%be%83%e7%83%ad%e8%ba%ab%e9%a2%98" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 class="heading-element" id="核心考点函数调用约定字符串地址访问"><span>核心考点：函数调用约定、字符串地址访问</span>
  <a href="#%e6%a0%b8%e5%bf%83%e8%80%83%e7%82%b9%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8%e7%ba%a6%e5%ae%9a%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%9c%b0%e5%9d%80%e8%ae%bf%e9%97%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><h4 class="heading-element" id="汇编逐行解析"><span>汇编逐行解析</span>
  <a href="#%e6%b1%87%e7%bc%96%e9%80%90%e8%a1%8c%e8%a7%a3%e6%9e%90" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">phase_1:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub</span>    <span class="no">$0x8</span><span class="p">,</span><span class="nv">%rsp</span>          <span class="c1">; 栈上分配 8 字节空间（对齐栈帧）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x402400</span><span class="p">,</span><span class="nv">%esi</span>     <span class="c1">; 第 2 个参数：目标字符串地址 0x402400 存入 %esi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="mh">401338</span> <span class="p">&lt;</span><span class="no">strings_not_equal</span><span class="p">&gt;</span>  <span class="c1">; 调用字符串比较函数，第 1 个参数（输入字符串）在 %rdi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">test</span>   <span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; 检查返回值：strings_not_equal 相等返回 0，不等返回 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">je</span>     <span class="mi">400</span><span class="no">ef7</span>             <span class="c1">; 若返回值为 0（ZF=1），跳转到安全区，炸弹不爆炸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span>       <span class="err">;</span> <span class="err">否则触发爆炸</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 class="heading-element" id="解法步骤"><span>解法步骤</span>
  <a href="#%e8%a7%a3%e6%b3%95%e6%ad%a5%e9%aa%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ol>
<li>启动 GDB：<code>gdb bomb</code>；</li>
<li>打断点：<code>b phase_1</code>；</li>
<li>运行程序：<code>r</code>，随便输入一个字符串（如 <code>test</code>），触发断点；</li>
<li>查看目标字符串：<code>x/s 0x402400</code>，直接显示答案。</li>
</ol>
<h4 class="heading-element" id="答案验证"><span>答案验证</span>
  <a href="#%e7%ad%94%e6%a1%88%e9%aa%8c%e8%af%81" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>输入 GDB 查看到的字符串：<code>Border relations with Canada have never been better.</code>，Phase 1 解除。</p>
<h3 class="heading-element" id="32-phase-2循环与栈数组序列推导"><span>3.2 Phase 2：循环与栈数组（序列推导）</span>
  <a href="#32-phase-2%e5%be%aa%e7%8e%af%e4%b8%8e%e6%a0%88%e6%95%b0%e7%bb%84%e5%ba%8f%e5%88%97%e6%8e%a8%e5%af%bc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 class="heading-element" id="核心考点栈上局部变量数组循环结构指针算术"><span>核心考点：栈上局部变量（数组）、循环结构、指针算术</span>
  <a href="#%e6%a0%b8%e5%bf%83%e8%80%83%e7%82%b9%e6%a0%88%e4%b8%8a%e5%b1%80%e9%83%a8%e5%8f%98%e9%87%8f%e6%95%b0%e7%bb%84%e5%be%aa%e7%8e%af%e7%bb%93%e6%9e%84%e6%8c%87%e9%92%88%e7%ae%97%e6%9c%af" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><h4 class="heading-element" id="汇编逐行解析-1"><span>汇编逐行解析</span>
  <a href="#%e6%b1%87%e7%bc%96%e9%80%90%e8%a1%8c%e8%a7%a3%e6%9e%90-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">phase_2:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub</span>    <span class="no">$0x28</span><span class="p">,</span><span class="nv">%rsp</span>         <span class="c1">; 栈上分配 40 字节（6个int数组 + 栈对齐，6*4=24，补16字节对齐）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">lea</span>    <span class="mi">0x10</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rsi</span>    <span class="c1">; 第 2 个参数：数组起始地址（%rsp+16）存入 %rsi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rdi</span>          <span class="c1">; 第 1 个参数：输入缓冲区地址存入 %rdi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="mh">40145c</span> <span class="p">&lt;</span><span class="no">read_six_numbers</span><span class="p">&gt;</span>  <span class="c1">; 读取 6 个整数，存入栈上数组（%rsp+16 开始）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="nf">cmpl</span>   <span class="no">$0x1</span><span class="p">,</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span>    <span class="c1">; 检查数组第 1 个元素（%rsp+16）是否为 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jne</span>    <span class="mi">400</span><span class="no">f3c</span>             <span class="c1">; 不是 1 则爆炸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="no">$0x1</span><span class="p">,</span><span class="nv">%ebx</span>          <span class="c1">; %ebx = 1（循环变量 i=1，从第 2 个元素开始检查）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x18</span><span class="p">,</span><span class="nv">%rbp</span>         <span class="c1">; %rbp = 24（数组第 6 个元素地址：%rsp+16 + 5*4 = %rsp+36？不对，重新计算：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                            <span class="c1">; 数组起始地址 %rsp+16，元素索引 0-5，地址为 %rsp+16 + i*4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                            <span class="c1">; %rbp 是循环结束边界：%rsp+16 + 6*4 = %rsp+32 = 0x20？
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">loop_start:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="p">-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbx</span><span class="p">),</span><span class="nv">%eax</span>    <span class="c1">; 取前一个元素：数组[i-1]（%rbx 是当前元素指针，-4 是前一个元素地址）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">add</span>    <span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; 前一个元素 *2（eax = eax * 2）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">cmp</span>    <span class="nv">%eax</span><span class="p">,(</span><span class="nv">%rbx</span><span class="p">)</span>        <span class="c1">; 比较当前元素（%rbx 指向）和前一个元素*2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">je</span>     <span class="no">loop_continue</span>      <span class="c1">; 相等则继续循环
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="err">&lt;</span><span class="no">explode_bomb</span><span class="err">&gt;</span>     <span class="c1">; 不等则爆炸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">loop_continue:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">add</span>    <span class="no">$0x4</span><span class="p">,</span><span class="nv">%rbx</span>          <span class="c1">; 指针移动到下一个元素（int 占 4 字节）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">cmp</span>    <span class="nv">%rbp</span><span class="p">,</span><span class="nv">%rbx</span>          <span class="c1">; 检查是否到达循环边界
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jne</span>    <span class="no">loop_start</span>         <span class="c1">; 未到则继续循环
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">add</span>    <span class="no">$0x28</span><span class="p">,</span><span class="nv">%rsp</span>         <span class="c1">; 释放栈空间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">retq</span>                      <span class="err">;</span> <span class="err">函数返回，</span><span class="no">Phase</span> <span class="mi">2</span> <span class="err">解除</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 class="heading-element" id="核心逻辑推导"><span>核心逻辑推导</span>
  <a href="#%e6%a0%b8%e5%bf%83%e9%80%bb%e8%be%91%e6%8e%a8%e5%af%bc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ul>
<li>输入要求：6 个整数（<code>read_six_numbers</code> 限制）；</li>
<li>第 1 个元素必须为 1；</li>
<li>从第 2 个元素开始，每个元素 = 前一个元素 × 2（等比数列）。</li>
</ul>
<h4 class="heading-element" id="解法步骤-1"><span>解法步骤</span>
  <a href="#%e8%a7%a3%e6%b3%95%e6%ad%a5%e9%aa%a4-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ol>
<li>断点：<code>b phase_2</code>，运行 <code>r</code> 后输入 <code>1 2 4 8 16 32</code>；</li>
<li>验证：GDB 中用 <code>x/6wd $rsp+16</code> 查看栈上数组，确认每个元素符合规律；</li>
<li>执行 <code>c</code>，炸弹不爆炸，Phase 2 解除。</li>
</ol>
<h4 class="heading-element" id="答案"><span>答案</span>
  <a href="#%e7%ad%94%e6%a1%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p><code>1 2 4 8 16 32</code></p>
<h3 class="heading-element" id="33-phase-3switch-跳转表多路分支"><span>3.3 Phase 3：Switch 跳转表（多路分支）</span>
  <a href="#33-phase-3switch-%e8%b7%b3%e8%bd%ac%e8%a1%a8%e5%a4%9a%e8%b7%af%e5%88%86%e6%94%af" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 class="heading-element" id="核心考点switch-case-底层实现跳转表多参数输入解析"><span>核心考点：switch-case 底层实现（跳转表）、多参数输入解析</span>
  <a href="#%e6%a0%b8%e5%bf%83%e8%80%83%e7%82%b9switch-case-%e5%ba%95%e5%b1%82%e5%ae%9e%e7%8e%b0%e8%b7%b3%e8%bd%ac%e8%a1%a8%e5%a4%9a%e5%8f%82%e6%95%b0%e8%be%93%e5%85%a5%e8%a7%a3%e6%9e%90" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><h4 class="heading-element" id="汇编逐行解析-2"><span>汇编逐行解析</span>
  <a href="#%e6%b1%87%e7%bc%96%e9%80%90%e8%a1%8c%e8%a7%a3%e6%9e%90-2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">phase_3:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub</span>    <span class="no">$0x18</span><span class="p">,</span><span class="nv">%rsp</span>         <span class="c1">; 栈上分配 24 字节
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">lea</span>    <span class="mi">0xc</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rcx</span>     <span class="c1">; 第 3 个参数：&amp;y（第二个输入整数的地址）存入 %rcx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">lea</span>    <span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdx</span>     <span class="c1">; 第 2 个参数：&amp;x（第一个输入整数的地址）存入 %rdx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x4025c3</span><span class="p">,</span><span class="nv">%esi</span>     <span class="c1">; 第 1 个参数：格式化字符串 &#34;%d %d&#34; 地址存入 %esi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rdi</span>          <span class="c1">; 第 0 个参数：输入缓冲区地址存入 %rdi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="mh">401353</span> <span class="p">&lt;</span><span class="no">__isoc99_sscanf</span><span class="p">&gt;</span>  <span class="c1">; 调用 sscanf(input, &#34;%d %d&#34;, &amp;x, &amp;y)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="nf">cmp</span>    <span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; sscanf 返回成功读取的参数个数，需 ≥1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jbe</span>    <span class="mi">400</span><span class="no">fad</span>             <span class="c1">; 读取失败（返回 0 或 1）则爆炸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">cmpl</span>   <span class="no">$0x7</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span>     <span class="c1">; 检查 x（%rsp+8）是否 &gt;7（无符号数）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">ja</span>     <span class="mi">400</span><span class="no">fad</span>             <span class="c1">; x&gt;7 则爆炸（switch default 分支）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%eax</span>     <span class="c1">; eax = x（作为跳转表索引）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jmpq</span>   <span class="p">*</span><span class="mi">0x402470</span><span class="p">(,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="c1">; 关键：跳转表寻址！地址 = 0x402470 + x*8（x86-64 地址占 8 字节）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1"># 以下是 switch 的 case 分支
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">case_0:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="no">$0xcf</span><span class="p">,</span><span class="nv">%eax</span>         <span class="c1">; eax = 207（十六进制 0xcf = 十进制 207）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jmp</span>    <span class="no">case_end</span>
</span></span><span class="line"><span class="cl"><span class="nl">case_1:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="no">$0x137</span><span class="p">,</span><span class="nv">%eax</span>        <span class="c1">; eax = 311（十六进制 0x137 = 十进制 311）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jmp</span>    <span class="no">case_end</span>
</span></span><span class="line"><span class="cl"><span class="na">...</span><span class="err">（省略</span> <span class="no">case_2</span> <span class="err">到</span> <span class="no">case_6</span><span class="err">）</span>
</span></span><span class="line"><span class="cl"><span class="nl">case_7:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="no">$0x147</span><span class="p">,</span><span class="nv">%eax</span>        <span class="c1">; eax = 327（十六进制 0x147 = 十进制 327）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jmp</span>    <span class="no">case_end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">case_end:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">cmp</span>    <span class="nv">%eax</span><span class="p">,</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span>     <span class="c1">; 比较 y（%rsp+c）和 eax（case 分支赋值的结果）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">je</span>     <span class="mi">400</span><span class="no">fc0</span>             <span class="c1">; 相等则安全，不等则爆炸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="err">&lt;</span><span class="no">explode_bomb</span><span class="err">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 class="heading-element" id="核心逻辑推导-1"><span>核心逻辑推导</span>
  <a href="#%e6%a0%b8%e5%bf%83%e9%80%bb%e8%be%91%e6%8e%a8%e5%af%bc-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ul>
<li>输入要求：2 个整数（x, y）；</li>
<li>x 必须是 0-7 之间的整数（否则触发 default 爆炸）；</li>
<li>switch 底层通过「跳转表」实现：<code>0x402470</code> 是跳转表起始地址，x 是索引，每个表项是 8 字节的代码地址；</li>
<li>每个 case 分支给 %eax 赋一个固定值，y 必须等于该值才能解除炸弹。</li>
</ul>
<h4 class="heading-element" id="解法步骤-2"><span>解法步骤</span>
  <a href="#%e8%a7%a3%e6%b3%95%e6%ad%a5%e9%aa%a4-2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ol>
<li>查看跳转表对应的 case 赋值：<br>
在 GDB 中执行 <code>x/8xg 0x402470</code>，会显示 8 个地址（对应 x=0-7），但更简单的方式是直接看汇编中 case 分支的 <code>mov $0x..., %eax</code> 指令；</li>
<li>任选一个 x（0-7），获取对应的 eax 值（即 y）；</li>
<li>输入 x 和 y，验证是否通过。</li>
</ol>
<h4 class="heading-element" id="答案-1"><span>答案</span>
  <a href="#%e7%ad%94%e6%a1%88-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ul>
<li>x=0 → y=207 → 输入 <code>0 207</code>；</li>
<li>x=1 → y=311 → 输入 <code>1 311</code>；</li>
<li>x=7 → y=327 → 输入 <code>7 327</code>；</li>
</ul>
<h3 class="heading-element" id="34-phase-4递归函数二分查找"><span>3.4 Phase 4：递归函数（二分查找）</span>
  <a href="#34-phase-4%e9%80%92%e5%bd%92%e5%87%bd%e6%95%b0%e4%ba%8c%e5%88%86%e6%9f%a5%e6%89%be" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 class="heading-element" id="核心考点递归调用栈帧生长二分查找逻辑"><span>核心考点：递归调用、栈帧生长、二分查找逻辑</span>
  <a href="#%e6%a0%b8%e5%bf%83%e8%80%83%e7%82%b9%e9%80%92%e5%bd%92%e8%b0%83%e7%94%a8%e6%a0%88%e5%b8%a7%e7%94%9f%e9%95%bf%e4%ba%8c%e5%88%86%e6%9f%a5%e6%89%be%e9%80%bb%e8%be%91" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><h4 class="heading-element" id="汇编逐行解析-3"><span>汇编逐行解析</span>
  <a href="#%e6%b1%87%e7%bc%96%e9%80%90%e8%a1%8c%e8%a7%a3%e6%9e%90-3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">phase_4:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub</span>    <span class="no">$0x18</span><span class="p">,</span><span class="nv">%rsp</span>         <span class="c1">; 栈上分配 24 字节
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">lea</span>    <span class="mi">0xc</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rcx</span>     <span class="c1">; 第 3 个参数：&amp;y 存入 %rcx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">lea</span>    <span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdx</span>     <span class="c1">; 第 2 个参数：&amp;x 存入 %rdx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x4025cf</span><span class="p">,</span><span class="nv">%esi</span>     <span class="c1">; 第 1 个参数：格式化字符串 &#34;%d %d&#34; 存入 %esi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rdi</span>          <span class="c1">; 第 0 个参数：输入缓冲区存入 %rdi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="err">&lt;</span><span class="no">__isoc99_sscanf</span><span class="err">&gt;</span>  <span class="c1">; 调用 sscanf(input, &#34;%d %d&#34;, &amp;x, &amp;y)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="nf">cmp</span>    <span class="no">$0x2</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; 必须成功读取 2 个整数，否则爆炸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jne</span>    <span class="mi">401062</span>
</span></span><span class="line"><span class="cl">  <span class="nf">cmpl</span>   <span class="no">$0xe</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span>     <span class="c1">; 检查 x 是否 &gt;14（0xe 是十进制 14）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">ja</span>     <span class="mi">401062</span>             <span class="c1">; x&gt;14 则爆炸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="no">$0xe</span><span class="p">,</span><span class="nv">%edx</span>          <span class="c1">; 第 3 个参数：high=14 存入 %edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x0</span><span class="p">,</span><span class="nv">%esi</span>          <span class="c1">; 第 2 个参数：low=0 存入 %esi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%edi</span>     <span class="c1">; 第 1 个参数：x 存入 %edi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="mh">401064</span> <span class="p">&lt;</span><span class="no">func4</span><span class="p">&gt;</span>     <span class="c1">; 调用递归函数 func4(x, 0, 14)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="nf">test</span>   <span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; 检查 func4 返回值是否为 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">je</span>     <span class="mi">40105</span><span class="no">b</span>             <span class="c1">; 返回 0 则安全
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="err">&lt;</span><span class="no">explode_bomb</span><span class="err">&gt;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">; 递归函数 func4 核心逻辑
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">func4:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub</span>    <span class="no">$0x8</span><span class="p">,</span><span class="nv">%rsp</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="nv">%edx</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; eax = high
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">sub</span>    <span class="nv">%esi</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; eax = high - low
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="nv">%eax</span><span class="p">,</span><span class="nv">%ecx</span>          <span class="c1">; ecx = high - low
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">shr</span>    <span class="no">$0x1f</span><span class="p">,</span><span class="nv">%ecx</span>         <span class="c1">; 算术右移 31 位，处理负数（符号扩展）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">add</span>    <span class="nv">%ecx</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; eax = (high - low + ecx) → 等价于 (high - low) // 2（整除）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">add</span>    <span class="nv">%esi</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; eax = low + (high - low)//2 → mid 值（二分查找中间值）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="nf">cmp</span>    <span class="nv">%edi</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; 比较 mid 和 x（参数 1）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jle</span>    <span class="no">func4_left</span>         <span class="c1">; mid ≤ x → 递归左半区
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="nv">%eax</span><span class="p">,</span><span class="nv">%edx</span>          <span class="c1">; mid &gt; x → high = mid - 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">dec</span>    <span class="nv">%edx</span>
</span></span><span class="line"><span class="cl">  <span class="nf">callq</span>  <span class="no">func4</span>
</span></span><span class="line"><span class="cl">  <span class="nf">add</span>    <span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; 返回值 *2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jmp</span>    <span class="no">func4_end</span>
</span></span><span class="line"><span class="cl"><span class="nl">func4_left:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">cmp</span>    <span class="nv">%edi</span><span class="p">,</span><span class="nv">%eax</span>
</span></span><span class="line"><span class="cl">  <span class="nf">je</span>     <span class="no">func4_end</span>          <span class="c1">; mid == x → 返回 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="nv">%eax</span><span class="p">,</span><span class="nv">%esi</span>          <span class="c1">; mid &lt; x → low = mid + 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">inc</span>    <span class="nv">%esi</span>
</span></span><span class="line"><span class="cl">  <span class="nf">callq</span>  <span class="no">func4</span>
</span></span><span class="line"><span class="cl">  <span class="nf">lea</span>    <span class="mi">0x1</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nv">%eax</span>  <span class="c1">; 返回值 = 2*ret +1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">func4_end:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">add</span>    <span class="no">$0x8</span><span class="p">,</span><span class="nv">%rsp</span>
</span></span><span class="line"><span class="cl">  <span class="nf">retq</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 class="heading-element" id="核心逻辑推导-2"><span>核心逻辑推导</span>
  <a href="#%e6%a0%b8%e5%bf%83%e9%80%bb%e8%be%91%e6%8e%a8%e5%af%bc-2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ul>
<li>输入要求：2 个整数（x, y）；</li>
<li>递归函数 <code>func4(x, low=0, high=14)</code> 的逻辑是<strong>二分查找</strong>：
<ol>
<li>计算 mid = (low + high) // 2；</li>
<li>若 mid &gt; x：递归调用 func4(x, low, mid-1)，返回值 = 2 * 子调用返回值；</li>
<li>若 mid &lt; x：递归调用 func4(x, mid+1, high)，返回值 = 2 * 子调用返回值 + 1；</li>
<li>若 mid == x：返回 0；</li>
</ol>
</li>
<li>最终要求 <code>func4</code> 返回值为 0，且 y 必须为 0。</li>
</ul>
<h4 class="heading-element" id="解法步骤-3"><span>解法步骤</span>
  <a href="#%e8%a7%a3%e6%b3%95%e6%ad%a5%e9%aa%a4-3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ol>
<li>要让 func4 返回 0，必须触发 base case（mid == x）；</li>
<li>二分查找的 base case 触发条件：x 是某轮递归的 mid 值，即 x 可以是 0、1、3、7、14（二分查找路径上的 mid）；</li>
<li>选择最简单的 x=0，此时 func4 直接返回 0，y 必须为 0。</li>
</ol>
<h4 class="heading-element" id="答案-2"><span>答案</span>
  <a href="#%e7%ad%94%e6%a1%88-2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p><code>0 0</code> 或 <code>1 0</code> 或 <code>3 0</code> 或 <code>7 0</code> 或 <code>14 0</code></p>
<h3 class="heading-element" id="35-phase-5位操作与字符映射"><span>3.5 Phase 5：位操作与字符映射</span>
  <a href="#35-phase-5%e4%bd%8d%e6%93%8d%e4%bd%9c%e4%b8%8e%e5%ad%97%e7%ac%a6%e6%98%a0%e5%b0%84" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 class="heading-element" id="核心考点位运算数组索引字符串映射"><span>核心考点：位运算、数组索引、字符串映射</span>
  <a href="#%e6%a0%b8%e5%bf%83%e8%80%83%e7%82%b9%e4%bd%8d%e8%bf%90%e7%ae%97%e6%95%b0%e7%bb%84%e7%b4%a2%e5%bc%95%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%98%a0%e5%b0%84" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><h4 class="heading-element" id="汇编逐行解析-4"><span>汇编逐行解析</span>
  <a href="#%e6%b1%87%e7%bc%96%e9%80%90%e8%a1%8c%e8%a7%a3%e6%9e%90-4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">phase_5:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub</span>    <span class="no">$0x20</span><span class="p">,</span><span class="nv">%rsp</span>         <span class="c1">; 栈上分配 32 字节
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="nv">%rdi</span><span class="p">,</span><span class="nv">%rbx</span>          <span class="c1">; 保存输入字符串地址（%rdi 是输入）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x6</span><span class="p">,</span><span class="nv">%edx</span>          <span class="c1">; edx = 6（字符串长度计数器）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; eax = 0（循环变量 i=0）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">len_check:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">movzbl</span> <span class="p">(</span><span class="nv">%rbx</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nv">%ecx</span> <span class="c1">; 取输入字符串第 i 个字符（零扩展为 32 位）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">test</span>   <span class="nv">%cl</span><span class="p">,</span><span class="nv">%cl</span>            <span class="c1">; 检查是否为字符串结束符 &#39;\0&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">je</span>     <span class="no">len_confirm</span>        <span class="c1">; 遇到 &#39;\0&#39; 则跳出长度检查
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">inc</span>    <span class="nv">%eax</span>               <span class="c1">; i++
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">cmp</span>    <span class="nv">%edx</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; 检查 i 是否超过 6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jne</span>    <span class="no">len_check</span>
</span></span><span class="line"><span class="cl"><span class="nl">len_confirm:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">cmp</span>    <span class="no">$0x6</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; 输入字符串长度必须为 6，否则爆炸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jne</span>    <span class="mi">4010</span><span class="no">d8</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; i=0（循环变量）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">map_loop:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">movzbl</span> <span class="p">(</span><span class="nv">%rbx</span><span class="p">,</span><span class="nv">%eax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nv">%ecx</span> <span class="c1">; 取输入字符串第 i 个字符 c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="nv">%cl</span><span class="p">,(</span><span class="nv">%rsp</span><span class="p">)</span>         <span class="c1">; 保存 c 到栈
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">and</span>    <span class="no">$0xf</span><span class="p">,</span><span class="nv">%ecx</span>          <span class="c1">; 关键：c &amp; 0xf（取低 4 位，掩码操作，范围 0-15）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">movzbl</span> <span class="mi">0x4024b0</span><span class="p">(</span><span class="nv">%rcx</span><span class="p">),</span><span class="nv">%edx</span> <span class="c1">; 查表：以低 4 位为索引，取 0x40240b 处数组的字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="nv">%dl</span><span class="p">,</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%eax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">; 保存映射后的字符到新字符串（栈上 0x10 开始）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">inc</span>    <span class="nv">%eax</span>               <span class="c1">; i++
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">cmp</span>    <span class="no">$0x6</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; 循环 6 次（处理 6 个字符）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jne</span>    <span class="no">map_loop</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="no">$0x40245e</span><span class="p">,</span><span class="nv">%esi</span>     <span class="c1">; 目标字符串地址 0x40245e 存入 %esi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">lea</span>    <span class="mi">0x10</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdi</span>    <span class="c1">; 映射后的新字符串地址存入 %rdi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="err">&lt;</span><span class="no">strings_not_equal</span><span class="err">&gt;</span> <span class="c1">; 比较新字符串和目标字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">test</span>   <span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span>
</span></span><span class="line"><span class="cl">  <span class="nf">je</span>     <span class="mi">4010</span><span class="no">f0</span>             <span class="c1">; 相等则安全，不等则爆炸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="err">&lt;</span><span class="no">explode_bomb</span><span class="err">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 class="heading-element" id="核心逻辑推导-3"><span>核心逻辑推导</span>
  <a href="#%e6%a0%b8%e5%bf%83%e9%80%bb%e8%be%91%e6%8e%a8%e5%af%bc-3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ul>
<li>输入要求：长度为 6 的字符串；</li>
<li>映射规则：输入字符的<strong>低 4 位</strong>作为索引，在一个硬编码数组（地址 0x4024b0）中查找对应的字符，生成新字符串；</li>
<li>新字符串必须与目标字符串（地址 0x40245e）完全一致。</li>
</ul>
<h4 class="heading-element" id="解法步骤-4"><span>解法步骤</span>
  <a href="#%e8%a7%a3%e6%b3%95%e6%ad%a5%e9%aa%a4-4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ol>
<li>查看目标字符串：<code>x/s 0x40245e</code> → 假设结果是 <code>flyers</code>；</li>
<li>查看映射数组：<code>x/s 0x4024b0</code> → 假设结果是 <code>maduiersnfotvbyl</code>；</li>
<li>逆向映射：目标字符 → 查找在映射数组中的索引→ 构造输入字符；</li>
</ol>
<table>
  <thead>
      <tr>
          <th>目标字符</th>
          <th>映射数组索引</th>
          <th>输入字符低 4 位</th>
          <th>合法输入字符</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>f</td>
          <td>9</td>
          <td>0x9</td>
          <td>&lsquo;9&rsquo;（0x39）、&lsquo;i&rsquo;（0x69）</td>
      </tr>
      <tr>
          <td>l</td>
          <td>15</td>
          <td>0xf</td>
          <td>&lsquo;o&rsquo;（0x6f）、&lsquo;O&rsquo;（0x4f）</td>
      </tr>
      <tr>
          <td>y</td>
          <td>14</td>
          <td>0xe</td>
          <td>&rsquo;n&rsquo;（0x6e）、&lsquo;N&rsquo;（0x4e）</td>
      </tr>
      <tr>
          <td>e</td>
          <td>5</td>
          <td>0x5</td>
          <td>&rsquo;e&rsquo;（0x65）、&lsquo;5&rsquo;（0x35）</td>
      </tr>
      <tr>
          <td>r</td>
          <td>6</td>
          <td>0x6</td>
          <td>&lsquo;f&rsquo;（0x66）、&lsquo;6&rsquo;（0x36）</td>
      </tr>
      <tr>
          <td>s</td>
          <td>7</td>
          <td>0x7</td>
          <td>&lsquo;g&rsquo;（0x67）、&lsquo;7&rsquo;（0x37）</td>
      </tr>
  </tbody>
</table>
<ol start="4">
<li>构造输入字符串：从每个位置的合法字符中任选一个，组成 6 字符字符串。</li>
</ol>
<h4 class="heading-element" id="答案-3"><span>答案</span>
  <a href="#%e7%ad%94%e6%a1%88-3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p><code>ionefg</code>（低 4 位分别为 9、0xf、0xe、5、6、7，映射后为 <code>flyers</code>）</p>
<h3 class="heading-element" id="36-phase-6链表排序"><span>3.6 Phase 6：链表排序</span>
  <a href="#36-phase-6%e9%93%be%e8%a1%a8%e6%8e%92%e5%ba%8f" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 class="heading-element" id="核心考点结构体指针链表遍历指针重排排序逻辑"><span>核心考点：结构体指针、链表遍历、指针重排、排序逻辑</span>
  <a href="#%e6%a0%b8%e5%bf%83%e8%80%83%e7%82%b9%e7%bb%93%e6%9e%84%e4%bd%93%e6%8c%87%e9%92%88%e9%93%be%e8%a1%a8%e9%81%8d%e5%8e%86%e6%8c%87%e9%92%88%e9%87%8d%e6%8e%92%e6%8e%92%e5%ba%8f%e9%80%bb%e8%be%91" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><h4 class="heading-element" id="汇编逐行解析-5"><span>汇编逐行解析</span>
  <a href="#%e6%b1%87%e7%bc%96%e9%80%90%e8%a1%8c%e8%a7%a3%e6%9e%90-5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">phase_6:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub</span>    <span class="no">$0x50</span><span class="p">,</span><span class="nv">%rsp</span>         <span class="c1">; 栈上分配 80 字节（存储 6 个指针 + 局部变量）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">lea</span>    <span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rsi</span>    <span class="c1">; 第 2 个参数：&amp;array 存入 %rsi（array 存储 6 个输入整数）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rdi</span>          <span class="c1">; 第 1 个参数：输入缓冲区存入 %rdi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="err">&lt;</span><span class="no">read_six_numbers</span><span class="err">&gt;</span> <span class="c1">; 读取 6 个整数到 array（%rsp+24 开始）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="c1">; 第一步：检查输入合法性（1-6 的全排列）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x0</span><span class="p">,</span><span class="nv">%ebx</span>          <span class="c1">; i=0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">check_duplicate:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbx</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nv">%eax</span> <span class="c1">; array[i]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">cmp</span>    <span class="no">$0x6</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; array[i] &gt;6 → 爆炸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">ja</span>     <span class="mi">4011</span><span class="no">c8</span>
</span></span><span class="line"><span class="cl">  <span class="nf">cmp</span>    <span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; array[i] &lt;1 → 爆炸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jb</span>     <span class="mi">4011</span><span class="no">c8</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="no">$0x0</span><span class="p">,</span><span class="nv">%ecx</span>          <span class="c1">; j=0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">check_inner:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">cmp</span>    <span class="nv">%rbx</span><span class="p">,</span><span class="nv">%ecx</span>          <span class="c1">; j == i → 跳过
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">je</span>     <span class="no">check_inner_end</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%ecx</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nv">%edx</span> <span class="c1">; array[j]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">cmp</span>    <span class="nv">%edx</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; array[i] == array[j] → 爆炸（重复）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">je</span>     <span class="mi">4011</span><span class="no">c8</span>
</span></span><span class="line"><span class="cl">  <span class="nf">inc</span>    <span class="nv">%ecx</span>               <span class="c1">; j++
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jmp</span>    <span class="no">check_inner</span>
</span></span><span class="line"><span class="cl"><span class="nl">check_inner_end:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">inc</span>    <span class="nv">%ebx</span>               <span class="c1">; i++
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">cmp</span>    <span class="no">$0x6</span><span class="p">,</span><span class="nv">%ebx</span>          <span class="c1">; 检查 6 个元素
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jne</span>    <span class="no">check_duplicate</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">; 第二步：反转映射（陷阱！）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x6</span><span class="p">,</span><span class="nv">%ebx</span>          <span class="c1">; i=6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">reverse_map:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">dec</span>    <span class="nv">%ebx</span>               <span class="c1">; i 从 5 到 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%ebx</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nv">%eax</span> <span class="c1">; array[i]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x7</span><span class="p">,</span><span class="nv">%edx</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub</span>    <span class="nv">%eax</span><span class="p">,</span><span class="nv">%edx</span>          <span class="c1">; array[i] = 7 - array[i]（反转：1→6，2→5，...，6→1）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="nv">%edx</span><span class="p">,</span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%ebx</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nf">cmp</span>    <span class="no">$0x0</span><span class="p">,</span><span class="nv">%ebx</span>
</span></span><span class="line"><span class="cl">  <span class="nf">jne</span>    <span class="no">reverse_map</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">; 第三步：构建链表节点指针数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x0</span><span class="p">,</span><span class="nv">%ebx</span>          <span class="c1">; i=0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">build_ptr_array:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%ebx</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nv">%eax</span> <span class="c1">; array[i]（反转后的值）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">lea</span>    <span class="mi">0x6032d0</span><span class="p">(</span><span class="nv">%rip</span><span class="p">),</span><span class="nv">%rdx</span> <span class="c1">; 链表头节点地址（假设 0x6032d0）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x0</span><span class="p">,</span><span class="nv">%ecx</span>          <span class="c1">; k=0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">find_node:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">cmp</span>    <span class="nv">%ecx</span><span class="p">,</span><span class="nv">%eax</span>          <span class="c1">; 找到第 array[i] 个节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">je</span>     <span class="no">find_node_end</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="p">(</span><span class="nv">%rdx</span><span class="p">),</span><span class="nv">%rdx</span>        <span class="c1">; 指针移动到下一个节点（rdx = node-&gt;next）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">inc</span>    <span class="nv">%ecx</span>               <span class="c1">; k++
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jmp</span>    <span class="no">find_node</span>
</span></span><span class="line"><span class="cl"><span class="nl">find_node_end:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="nv">%rdx</span><span class="p">,</span><span class="mi">0x30</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%ebx</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="c1">; 存储节点指针到 ptr_array[i]（8字节指针）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">inc</span>    <span class="nv">%ebx</span>
</span></span><span class="line"><span class="cl">  <span class="nf">cmp</span>    <span class="no">$0x6</span><span class="p">,</span><span class="nv">%ebx</span>
</span></span><span class="line"><span class="cl">  <span class="nf">jne</span>    <span class="no">build_ptr_array</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">; 第四步：重组链表（按 ptr_array 顺序串联）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="no">$0x1</span><span class="p">,</span><span class="nv">%ebx</span>          <span class="c1">; i=1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">link_list:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="mi">0x30</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%ebx</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="nv">%rdx</span> <span class="c1">; ptr_array[i]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="mi">0x30</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbx</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="nv">%rax</span> <span class="c1">; ptr_array[i-1]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="nv">%rdx</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rax</span><span class="p">)</span>     <span class="c1">; ptr_array[i-1]-&gt;next = ptr_array[i]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">inc</span>    <span class="nv">%ebx</span>
</span></span><span class="line"><span class="cl">  <span class="nf">cmp</span>    <span class="no">$0x6</span><span class="p">,</span><span class="nv">%ebx</span>
</span></span><span class="line"><span class="cl">  <span class="nf">jne</span>    <span class="no">link_list</span>
</span></span><span class="line"><span class="cl">  <span class="nf">movq</span>   <span class="no">$0x0</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rdx</span><span class="p">)</span>     <span class="c1">; 最后一个节点的 next = NULL
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">  <span class="c1">; 第五步：检查链表是否降序排列
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">lea</span>    <span class="mi">0x30</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rbx</span>    <span class="c1">; 链表头指针（ptr_array[0]）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">check_sorted:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="p">(</span><span class="nv">%rbx</span><span class="p">),</span><span class="nv">%rax</span>        <span class="c1">; current = head
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbx</span><span class="p">),</span><span class="nv">%rbx</span>     <span class="c1">; head = head-&gt;next
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">test</span>   <span class="nv">%rbx</span><span class="p">,</span><span class="nv">%rbx</span>          <span class="c1">; 到达链表尾 → 检查通过
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">je</span>     <span class="mi">401234</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mov</span>    <span class="mi">0x4</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%edx</span>     <span class="c1">; current-&gt;value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">mov</span>    <span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbx</span><span class="p">),</span><span class="nv">%ecx</span>     <span class="c1">; next-&gt;value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">cmp</span>    <span class="nv">%ecx</span><span class="p">,</span><span class="nv">%edx</span>          <span class="c1">; current-&gt;value &gt;= next-&gt;value → 降序
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">jge</span>    <span class="no">check_sorted</span>       <span class="c1">; 符合则继续检查
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">callq</span>  <span class="err">&lt;</span><span class="no">explode_bomb</span><span class="err">&gt;</span>     <span class="err">;</span> <span class="err">不符合则爆炸</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 class="heading-element" id="核心逻辑推导-4"><span>核心逻辑推导</span>
  <a href="#%e6%a0%b8%e5%bf%83%e9%80%bb%e8%be%91%e6%8e%a8%e5%af%bc-4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ul>
<li>输入要求：6 个整数，必须是 1-6 的全排列（无重复、无超出范围）；</li>
<li>关键陷阱：输入的每个数会被转换为 <code>7 - x</code>（如输入 1→6，输入 6→1）；</li>
<li>链表结构：内存中存在一个链表，每个节点包含 <code>value</code>（4字节）、<code>id</code>（4字节）、<code>next</code>（8字节指针）；</li>
<li>重组规则：根据转换后的输入数，从原链表中取出对应节点，按输入顺序串联成新链表；</li>
<li>最终要求：新链表的 <code>value</code> 必须<strong>降序排列</strong>。</li>
</ul>
<h4 class="heading-element" id="解法步骤核心三步"><span>解法步骤（核心三步）</span>
  <a href="#%e8%a7%a3%e6%b3%95%e6%ad%a5%e9%aa%a4%e6%a0%b8%e5%bf%83%e4%b8%89%e6%ad%a5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ol>
<li>查看原链表节点的 <code>value</code>：<br>
链表头地址通常在 <code>0x6032d0</code>（汇编中 <code>lea 0x6032d0(%rip),%rdx</code>），用 <code>x/20dw 0x6032d0</code> 查看节点值：<br>
假设节点 1-6 的 value 为：<code>168, 332, 728, 516, 471, 224</code>（需按实际地址查询）；</li>
<li>对节点 value 降序排序，记录对应的<strong>原节点编号</strong>（1-6）：<br>
降序 value：728（节点3）→ 516（节点4）→ 471（节点5）→ 332（节点2）→ 224（节点6）→ 168（节点1）；</li>
<li>应对反转映射：输入数 = <code>7 - 原节点编号</code>（因为代码中 <code>array[i] = 7 - array[i]</code>）：<br>
原节点编号：3 → 输入 4（7-3=4）；<br>
原节点编号：4 → 输入 3（7-4=3）；<br>
原节点编号：5 → 输入 2（7-5=2）；<br>
原节点编号：2 → 输入 5（7-2=5）；<br>
原节点编号：6 → 输入 1（7-6=1）；<br>
原节点编号：1 → 输入 6（7-1=6）；</li>
</ol>
<h4 class="heading-element" id="答案需按实际链表值调整"><span>答案（需按实际链表值调整）</span>
  <a href="#%e7%ad%94%e6%a1%88%e9%9c%80%e6%8c%89%e5%ae%9e%e9%99%85%e9%93%be%e8%a1%a8%e5%80%bc%e8%b0%83%e6%95%b4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p><code>4 3 2 5 1 6</code></p></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2025-12-01 19:23:27">Updated on 2025-12-01&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/posts/017d597/index.md" title="Read Markdown" class="link-to-markdown">Read Markdown</a></span><span><a href="vscode://file/W:%5ctool%5cblog%5c7M7%5ccontent%5cposts%5cBomblab.md" title="Open in editor"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Open in editor</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://localhost:1313/posts/017d597/" data-title="CSAPP Bomb Lab 详细解析与复习笔记"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/csapp/" class="post-tag" title="Tags - CSAPP">CSAPP</a><a href="/tags/%E6%B1%87%E7%BC%96/" class="post-tag" title="Tags - 汇编">汇编</a><a href="/tags/linux/" class="post-tag" title="Tags - Linux">Linux</a><a href="/tags/gdb/" class="post-tag" title="Tags - GDB">GDB</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/017d599/" class="post-nav-item" rel="prev" title="8086 汇编系统笔记：内存分段、栈、寻址与控制转移"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>8086 汇编系统笔记：内存分段、栈、寻址与控制转移</a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.150.0"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.20">FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="/">7M7</a></span></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Total visitors'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Total visits'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><a href="https://github.com/7M7666" title="View me on GitHub"target="_blank" rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><div id="mask"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="preload" href="/lib/katex/katex.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/katex/katex.min.css"></noscript><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><link rel="stylesheet" href="/lib/pace/themes/black/pace-theme-minimal.css"><link rel="stylesheet" href="/css/custom.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="/lib/pangu/pangu.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":10},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"pangu":{"enable":true,"selector":"article"},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/search.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"No results found","snippetLength":30,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"version":"v0.3.20"};console.log('Page config:', window.config);</script><script src="/js/theme.min.js" defer></script><script src="/js/custom.min.js" defer></script></body>
</html>
